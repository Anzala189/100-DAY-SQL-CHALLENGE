-- SOLVING QUESTIONS FROM UDEMY COURSE  “100 Days of SQL: Ace the SQL Interviews Like a PRO!!” by Ankit Bansal on Udemy 

-- how many matches they played 
-- how many matches they won
-- how many they lost. That’s it. Simple cricket points table
-- Script 1 :
CREATE DATABASE MATCH_WORLDCUP;
CREATE TABLE ICC_WORLD_CUP
(
TEAM_1 VARCHAR(20),
TEAM_2 VARCHAR(20),
WINNER VARCHAR(20)
);
INSERT INTO ICC_WORLD_CUP VALUES('INDIA','SL','INDIA');
INSERT INTO ICC_WORLD_CUP VALUES('SL','AUS','AUS');
INSERT INTO ICC_WORLD_CUP VALUES('SA','ENG','ENG');
INSERT INTO ICC_WORLD_CUP VALUES('ENG','NZ','NZ');
INSERT INTO ICC_WORLD_CUP VALUES('AUS','INDIA','INDIA');

SELECT*FROM icc_world_cup;

-- SOLUTION
WITH CTE1 AS (
    SELECT TEAM_1 AS TEAM_NAME, WINNER FROM ICC_WORLD_CUP
    UNION ALL
    SELECT TEAM_2 AS TEAM_NAME, WINNER FROM ICC_WORLD_CUP
),
CTE2 AS (
    SELECT 
        TEAM_NAME,
        COUNT(*) AS NO_MATCHES_PLAYED,
        SUM(CASE WHEN WINNER = TEAM_NAME THEN 1 ELSE 0 END) AS NO_MATCHES_WON
    FROM CTE1
    GROUP BY TEAM_NAME
)
SELECT *,
       (NO_MATCHES_PLAYED - NO_MATCHES_WON) AS NO_OF_LOSSES
FROM CTE2
ORDER BY NO_MATCHES_WON DESC, NO_OF_LOSSES;
SELECT*FROM icc_world_cup;

![Dashboard Screenshot](images/dashboard.png)








