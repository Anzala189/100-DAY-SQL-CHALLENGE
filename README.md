# 100-DAY-SQL-CHALLENGE
-- SOLVING QUESTIONS FROM UDEMY COURSE  “100 Days of SQL: Ace the SQL Interviews Like a PRO!!” by Ankit Bansal on Udemy 

QUESTION#1:

-- how many matches they played 
-- how many matches they won
-- how many they lost. That’s it. Simple cricket points table

-- Script 1 :

CREATE DATABASE MATCH_WORLDCUP;
CREATE TABLE ICC_WORLD_CUP
(
TEAM_1 VARCHAR(20),
TEAM_2 VARCHAR(20),
WINNER VARCHAR(20)
);
INSERT INTO ICC_WORLD_CUP VALUES('INDIA','SL','INDIA');
INSERT INTO ICC_WORLD_CUP VALUES('SL','AUS','AUS');
INSERT INTO ICC_WORLD_CUP VALUES('SA','ENG','ENG');
INSERT INTO ICC_WORLD_CUP VALUES('ENG','NZ','NZ');
INSERT INTO ICC_WORLD_CUP VALUES('AUS','INDIA','INDIA');

SELECT*FROM icc_world_cup;

-- SOLUTION

WITH CTE1 AS (
    SELECT TEAM_1 AS TEAM_NAME, WINNER FROM ICC_WORLD_CUP
    UNION ALL
    SELECT TEAM_2 AS TEAM_NAME, WINNER FROM ICC_WORLD_CUP
),
CTE2 AS (
    SELECT 
        TEAM_NAME,
        COUNT(*) AS NO_MATCHES_PLAYED,
        SUM(CASE WHEN WINNER = TEAM_NAME THEN 1 ELSE 0 END) AS NO_MATCHES_WON
    FROM CTE1
    GROUP BY TEAM_NAME
)
SELECT *,
       (NO_MATCHES_PLAYED - NO_MATCHES_WON) AS NO_OF_LOSSES
FROM CTE2
ORDER BY NO_MATCHES_WON DESC, NO_OF_LOSSES;
SELECT*FROM icc_world_cup;

![image](https://github.com/Anzala189/100-DAY-SQL-CHALLENGE/blob/c7a07cad66fadd64bbc224d9d3afe37598d7421d/image.png)

QUESTION#2:

-- Day 2 Problem
-- Day 2 : Find the employees with salary more than their manager salary
-- Script 2 :
CREATE DATABASE employeessalary_managersalary; 
CREATE TABLE EMP(EMP_ID INT,EMP_NAME VARCHAR(10),SALARY INT ,MANAGER_ID INT);
INSERT INTO EMP VALUES(1,'ANKIT',10000,4);
INSERT INTO EMP VALUES(2,'MOHIT',15000,5);
INSERT INTO EMP VALUES(3,'VIKAS',10000,4);
INSERT INTO EMP VALUES(4,'ROHIT',5000,2);
INSERT INTO EMP VALUES(5,'MUDIT',12000,6);
INSERT INTO EMP VALUES(6,'AGAM',12000,2);
INSERT INTO EMP VALUES(7,'SANJAY',9000,2);
INSERT INTO EMP VALUES(8,'ASHISH',5000,2);

SELECT * FROM EMP;

--SOLUTION:

SELECT E.EMP_ID, E.EMP_NAME, M.EMP_NAME AS MANAGER_NAME, E.SALARY, M.SALARY AS "MANAGER SALARY" 

FROM EMP E INNER JOIN EMP M ON M.EMP_ID = E.MANAGER_ID 

WHERE E.SALARY > M.SALARY

ORDER BY E.EMP_NAME ASC;

![image](https://github.com/Anzala189/100-DAY-SQL-CHALLENGE/blob/c7a07cad66fadd64bbc224d9d3afe37598d7421d/images/Day_2_employeesalary%20more%20than%20managersalary.jpg)












